import numpy as np
import matplotlib.pyplot as plt
import csv

##____________________THE FOLLOWING CODE PLOTS AN EXAMPLE OF A MOLECULE AND ITS PREDICTION______________________##
pred_data = "/home/itaha/chemprop-IR/chemprop/data/final_pred.csv"

# Extract columns as separate vectors
x=range(150,451,6)
y_scale=[3.019364968738831e-09,4.287556588082876e-08,1.2702768648071517e-06,2.36857573020991e-05,0.00027963113740822696,0.002110402644242837,0.010335084973543239,0.033537805854496804,0.07388558508497882,0.11273271389569652,0.11995148887822502,0.08829860954648681,0.044451035967840384,0.016307751703536464,0.0088501405619952,0.01606039258356835,0.0335859125486723,0.05283466116849321,0.058931297006817235,0.047492844892988266,0.030565979067334447,0.018601265707993433,0.011566719578849034,0.007153771165313191,0.0048118397796367085,0.0035599827989084847,0.0030990106105336546,0.006230460885238321,0.017069355005635084,0.032643265759869956,0.038853918612985656,0.028528927955389555,0.013504694501163114,0.005626946942689832,0.005373837930664891,0.009947640398699867,0.015138429092384092,0.014882358159480226,0.009003106085154196,0.003316403747150634,0.0007421419988935832,0.00010083892048086891,8.318436518951066e-06,4.165975429161808e-07,1.2666329552697063e-08,2.337994123956619e-10,2.619958930202056e-12,1.7823950281286344e-14,7.361593718821325e-17,1.8458573370038624e-19,2.8098479672963112e-22]
y_pred = []

# Read the CSV file
with open(pred_data, 'r') as pred_file:
  reader = csv.reader(pred_file)

  # Skip the header
  next(reader)

  # Extract values from the second row and second column
  for row in reader:
      values = [float(value) for value in row[1:]]  # slicing to get elements from index 1 onwards
      y_pred.extend(values)  # extend to add all elements from the list

# Plot the scaled data and prediction 
y_pred = np.array(y_pred) / sum(y_pred)  
plt.plot(x,y_pred,'b')
print(sum(y_scale))
plt.plot(x,y_scale,'r')
plt.show()
