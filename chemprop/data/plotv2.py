import numpy as np
import matplotlib.pyplot as plt
import csv
import wandb

wandb.init(project="Chemprop-IR")  # Initialize a new Wandb run

#All obtained from ornl_aisd_ex_1_trimmed_smoothed_norm.csv
pred_data = "/home/itaha/chemprop-IR/chemprop/data/final_pred.csv"
x=range(150,451,6)
#COC1(CNC(=O)OCC(=O)N(C)Cc2ccc(OC(F)F)cc2)Cc2ccccc2C1
y_1 = [2.46301773372375e-13,5.573146641855792e-11,3.7398757200143835e-09,1.5301360160402142e-07,3.816569832638471e-06,5.8044119478849695e-05,0.0005387242164199379,0.003060567376209098,0.010745173953766776,0.023998746052945684,0.03682214430131036,0.04464913688527852,0.047354278426356415,0.04290568005650325,0.0367642616557999,0.041654223463838826,0.05396888582422581,0.05386620737750419,0.0373567080524417,0.02380863898101211,0.03300995155232346,0.07269218203871483,0.12250768383713588,0.13580163390685873,0.09772788015295363,0.046466952892856114,0.015365188399177701,0.004182719041117093,0.0015183206070651678,0.0013653051408730496,0.0023300835906688066,0.003403459668718221,0.003239667841311644,0.0019236408863517731,0.0007127673520578826,0.00016789172594814517,2.6170679795606815e-05,2.863059274863277e-06,2.296405403082866e-07,1.332256506651882e-08,5.278255924986377e-10,1.351499418341954e-11,2.1628150232460998e-13,2.127995962422873e-15,1.277908570966841e-17,4.669333854192622e-20,1.036740979358148e-22,1.3980106594653788e-25,1.1446640028930723e-28,5.690265060777782e-32,1.717343523918798e-35]
y_1_pred = [4.728241947304923e-06,2.796325679810252e-05,7.651742635061964e-05,0.0003076129942201078,0.0018846888560801744,0.012904795818030834,0.07222668826580048,0.29520463943481445,0.8573809266090393,1.7806634902954102,2.828589677810669,3.840155839920044,5.036559581756592,6.689817428588867,8.959756851196289,11.703516960144043,14.513792037963867,16.58949089050293,17.487489700317383,17.42327308654785,16.500272750854492,14.937727928161621,13.070359230041504,11.026297569274902,9.2494478225708,7.854726791381836,6.897944450378418,6.080704212188721,5.2723798751831055,4.435842037200928,3.6014444828033447,2.7962701320648193,2.095686912536621,1.446153998374939,0.9490264058113098,0.5889534950256348,0.3517911732196808,0.20531997084617615,0.11976776272058487,0.06748160719871521,0.039159730076789856,0.023358860984444618,0.014421376399695873,0.009782944805920124,0.0071724350564181805,0.005278079304844141,0.0038841250352561474,0.002707727951928973,0.0018302943790331483,0.001286094542592764,0.0009761406690813601]
y_1_pred = np.array(y_1_pred) / sum(y_1_pred) 

#COCCn1c(Cc2nnc(C(F)(F)F)o2)nnc1N(C)Cc1cccc(C)c1
y_2 = [5.528671128440646e-12,1.771593453905995e-10,1.064124981857199e-08,3.8829188790328574e-07,8.60882690802453e-06,0.00011600411061740347,0.0009504729640667637,0.004739004546413986,0.01440620907840454,0.026892612923939168,0.03194384907592017,0.028784738518459096,0.03150278017099229,0.0470465011306635,0.0660494966592263,0.07849028803269062,0.08048559196193145,0.06950839088637391,0.051083437632741355,0.037883456451608254,0.034947572603343274,0.04246536761490998,0.05646011065804686,0.05972037879702302,0.04312813263246566,0.023406463730248867,0.01789773468371278,0.024832404772764143,0.031745522304339815,0.029821614066362946,0.020293547816099537,0.010220888578571384,0.00451789790163404,0.002976789076384441,0.003814302999431433,0.005396541753575564,0.005489125022528252,0.00353211912928506,0.001453554035987111,0.0006715177553142277,0.0010799218183526543,0.0019041250006347783,0.002124042494872703,0.0014413441690280982,0.0005938444602877909,0.00014853819557492155,2.255599958652704e-05,2.0794305484588867e-06,1.1638182549841114e-07,3.9544338345099614e-09,8.157214166270733e-11]
y_2_pred = [1.8740245650405996e-05,0.00040855497354641557,0.003900557989254594,0.03223660588264465,0.2020629346370697,0.8974251747131348,2.8708391189575195,6.652853012084961,11.736727714538574,16.256044387817383,18.738666534423828,19.596723556518555,19.987274169921875,20.665695190429688,21.60794448852539,22.815916061401367,23.870758056640625,24.114784240722656,23.30440330505371,21.254756927490234,18.75267791748047,16.0953426361084,13.653560638427734,11.68425178527832,9.752631187438965,8.170071601867676,6.970600128173828,5.961339950561523,5.116942882537842,4.470764636993408,3.959991931915283,3.497574806213379,3.0433382987976074,2.627833604812622,2.2205588817596436,1.780709147453308,1.3195209503173828,0.9678620100021362,0.6935923099517822,0.4572708010673523,0.3088890016078949,0.1991816908121109,0.1390870064496994,0.09924078732728958,0.07760385423898697,0.06128814443945885,0.04731050878763199,0.03763013333082199,0.027682382613420486,0.020384492352604866,0.013619773089885712]
y_2_pred = np.array(y_2_pred) / sum(y_2_pred) 

#CCn1cnc(C(=O)NCC=CCNCCc2ccc(OC)c(F)c2)c1
y_3 = [2.6061048641316305e-07,1.4783493551576776e-06,2.201869589335278e-05,0.00020335430895862763,0.00117657183163673,0.004341365128781683,0.01058719346581413,0.018445822687888528,0.02670107575546991,0.038141247797709575,0.05470077171456491,0.07020044004278193,0.07624254119433502,0.07264151023816534,0.06223311071027455,0.044827636513513264,0.025174123135008084,0.01489783990657193,0.021646883454830134,0.04541894681991426,0.08105048707478572,0.11028172103853852,0.10443250378784595,0.06435004798380393,0.025486965134776916,0.00798274095597513,0.004310337109150561,0.0035921096405748918,0.002523506249736965,0.0017893319111012503,0.0014950203623616055,0.0010435663015297772,0.000505790274172918,0.0002920998039456807,0.000497635541453422,0.0008616222582869382,0.000943851477603079,0.0006292180595889825,0.00025469327671488425,6.258865880221558e-05,9.33753861988524e-06,8.457219283028224e-07,4.6503021887839686e-08,1.5523625698791806e-09,3.14603502215043e-11,3.8707252578531053e-13,2.8912093718827373e-15,1.3110677743463912e-17,3.609351227677644e-20,6.032419726622917e-23,6.120858793099744e-26]
y_3_pred = [8.878347216523252e-06,0.0001659985864534974,0.002337902318686247,0.024095386266708374,0.1609233319759369,0.6948941349983215,2.0780632495880127,4.566845893859863,7.744406700134277,10.948046684265137,13.470396041870117,14.907526016235352,15.600244522094727,15.482829093933105,14.888266563415527,14.022727012634277,13.59199333190918,13.418855667114258,13.490129470825195,13.282320976257324,12.41642951965332,11.242289543151855,9.947775840759277,8.852168083190918,7.756406784057617,6.755385875701904,5.773170471191406,4.651978969573975,3.5749146938323975,2.6052331924438477,1.7721872329711914,1.1426466703414917,0.7155530452728271,0.4121749997138977,0.22425656020641327,0.12018270045518875,0.06542235612869263,0.036093614995479584,0.020215606316924095,0.01223963126540184,0.0076818810775876045,0.005090519320219755,0.0035876287147402763,0.0025445737410336733,0.00183851586189121,0.0013897877652198076,0.001075803767889738,0.0008512248168699443,0.0006560546462424099,0.0005481517873704433,0.00048568210331723094]
y_3_pred = np.array(y_3_pred) / sum(y_3_pred) 

#CN=C(NCCc1ccccc1OCc1ccccc1)Nc1nn[nH]c1C(=O)N1CCOCC1
y_4 = [5.418073051956667e-23,2.358374904223064e-20,1.2062612672443148e-17,3.76570360988932e-15,7.177514078159049e-13,8.35796771564902e-11,5.952229615137968e-09,2.5966248958187766e-07,6.955324236843403e-06,0.00011477943385935151,0.001172338938662042,0.007456835316721561,0.029777328140699052,0.07548530777622342,0.12354888342519552,0.1344217509979391,0.10226723963644316,0.05895668849763299,0.030078191920170225,0.020675904030439233,0.027761999443115283,0.049093038591977604,0.07630484857234843,0.08782433981379982,0.07051586004617079,0.040454775914664114,0.019625789655028383,0.0107520073818279,0.006483020612386565,0.0034956608273841523,0.0026058300591723666,0.004099757182971858,0.0060278790945009035,0.005824147746348733,0.0035141395453691395,0.0013092021727952386,0.00029952167356439916,4.193512409726869e-05,3.5845897189447375e-06,1.8677418559644813e-07,5.925595792687822e-09,1.143817863003105e-10,1.3426624846870543e-12,9.580954509367728e-15,4.1550714203598175e-17,1.0949780397762418e-19,1.7532418124506115e-22,1.7055150373661697e-25,1.0079173874425811e-28,3.6185564472921826e-32,7.891814621952478e-36]
y_4_pred = [2.3370114377030404e-06,9.659540410211775e-06,2.0008143110317178e-05,3.388452751096338e-05,4.625440851668827e-05,8.927784801926464e-05,0.00022347885533235967,0.0008766443934291601,0.005555629264563322,0.037284284830093384,0.2141430377960205,0.9751859903335571,3.2950668334960938,8.188568115234375,15.2372407913208,22.30846405029297,27.29071807861328,29.844131469726562,30.659421920776367,30.620397567749023,30.549598693847656,30.238431930541992,29.407909393310547,28.60647964477539,27.33945083618164,26.025146484375,24.0731258392334,22.078147888183594,18.80599021911621,15.501879692077637,12.590449333190918,10.018688201904297,7.813650131225586,5.75297737121582,4.1175312995910645,2.8544490337371826,2.040595293045044,1.4469482898712158,1.0124167203903198,0.6626362204551697,0.40916624665260315,0.23892341554164886,0.13993382453918457,0.08313079923391342,0.05244098976254463,0.03424040600657463,0.022701557725667953,0.01534933689981699,0.010783557780086994,0.007906426675617695,0.006385434418916702]
y_4_pred = np.array(y_4_pred) / sum(y_4_pred) 

#COc1cc(NC(=O)CCc2nc(=O)c3cnn(C4CCCC4)c3[nH]2)c(F)cc1SC#N
y_5 = [4.5309456189104135e-15,2.285291009130585e-13,2.8821950826175926e-11,2.2245349743087536e-09,1.0481719121195628e-07,3.0112035351244417e-06,5.2737880622675204e-05,0.0005640512470676746,0.0037029266273144166,0.015103083154502647,0.039275278417194276,0.06834927218679039,0.08567969796089978,0.08464844269400348,0.07351135346309873,0.06270369053024931,0.05289315046519611,0.04071752078288348,0.027155917950895836,0.015580177919879735,0.00838025774639097,0.0060390874308665415,0.0070947472269590845,0.01103260107514301,0.023650489194103678,0.05249844058198316,0.08775724820789653,0.09814179848418972,0.0702017248308765,0.031380468665109205,0.008652718274749895,0.0014614833329976756,0.00015106097586064645,1.4688821787027681e-05,5.1123282922053744e-05,0.00033850391233573927,0.0014489175657293415,0.003849808557212093,0.006262309426910549,0.006203496620443994,0.003735035437298527,0.00136583211650987,0.0003032709904134988,4.0884108024502196e-05,3.346216509900853e-06,1.662742240297142e-07,5.016103266038618e-09,9.204477337021326e-11,2.1580134610846123e-11,1.4776874835827927e-09,6.448022623557043e-08]
y_5_pred = [1.262881283992101e-07,1.2395615840432583e-06,1.2248953680682462e-05,6.530922109959647e-05,0.0003968379460275173,0.003228145418688655,0.030021363869309425,0.20646247267723083,0.9461451768875122,3.110470771789551,7.548466682434082,13.702492713928223,19.23531723022461,21.582427978515625,20.64868927001953,17.819236755371094,14.791726112365723,12.285265922546387,10.33953857421875,8.850979804992676,7.633640766143799,6.662810802459717,5.8544135093688965,5.189179420471191,4.580833435058594,3.97243070602417,3.418055534362793,2.895474910736084,2.394782304763794,1.9138060808181763,1.5711308717727661,1.3170390129089355,1.1150946617126465,0.9468475580215454,0.8131930232048035,0.698742687702179,0.6164689064025879,0.5582797527313232,0.5087834000587463,0.4533683657646179,0.38426968455314636,0.3169923424720764,0.26485952734947205,0.2257724404335022,0.20278890430927277,0.17945647239685059,0.1573691964149475,0.13273420929908752,0.10631556808948517,0.0885336846113205,0.07435033470392227]
y_5_pred = np.array(y_5_pred) / sum(y_5_pred) 

#
y_6 = [3.019364968738831e-09,4.287556588082876e-08,1.2702768648071517e-06,2.36857573020991e-05,0.00027963113740822696,0.002110402644242837,0.010335084973543239,0.033537805854496804,0.07388558508497882,0.11273271389569652,0.11995148887822502,0.08829860954648681,0.044451035967840384,0.016307751703536464,0.0088501405619952,0.01606039258356835,0.0335859125486723,0.05283466116849321,0.058931297006817235,0.047492844892988266,0.030565979067334447,0.018601265707993433,0.011566719578849034,0.007153771165313191,0.0048118397796367085,0.0035599827989084847,0.0030990106105336546,0.006230460885238321,0.017069355005635084,0.032643265759869956,0.038853918612985656,0.028528927955389555,0.013504694501163114,0.005626946942689832,0.005373837930664891,0.009947640398699867,0.015138429092384092,0.014882358159480226,0.009003106085154196,0.003316403747150634,0.0007421419988935832,0.00010083892048086891,8.318436518951066e-06,4.165975429161808e-07,1.2666329552697063e-08,2.337994123956619e-10,2.619958930202056e-12,1.7823950281286344e-14,7.361593718821325e-17,1.8458573370038624e-19,2.8098479672963112e-22]
y_6_pred = [5.182834684092086e-06,7.048840052448213e-05,0.0006665810942649841,0.0054934159852564335,0.04589954763650894,0.33758097887039185,1.749933123588562,6.05305290222168,14.351916313171387,23.466678619384766,26.156808853149414,20.621137619018555,13.10290241241455,8.02164363861084,5.370700359344482,4.151657581329346,3.7348146438598633,3.812108278274536,4.25446081161499,4.9674072265625,5.7895588874816895,6.443445205688477,6.7343926429748535,6.6610846519470215,6.341990947723389,5.971339702606201,5.546581745147705,5.150148868560791,4.700880527496338,4.31781005859375,3.938007354736328,3.5812954902648926,3.238186836242676,2.906047821044922,2.622006416320801,2.2920517921447754,2.0372262001037598,1.6748759746551514,1.2612448930740356,0.8905962705612183,0.5835914015769958,0.36586055159568787,0.22268906235694885,0.12914089858531952,0.07109657675027847,0.040921807289123535,0.024228548631072044,0.014592422172427177,0.00907079502940178,0.005572514142841101,0.0036865277215838432]
y_6_pred = np.array(y_6_pred) / sum(y_6_pred) 

plt.plot(x,y_1,'b')
plt.plot(x,y_1_pred,'r')

fig, axs = plt.subplots(3, 2, figsize=(12, 8))

# Data for plotting
y_data = [y_1, y_2, y_3, y_4, y_5, y_6]
y_pred_data = [y_1_pred, y_2_pred, y_3_pred, y_4_pred, y_5_pred, y_6_pred]

# Plot each set of data on corresponding subplot
for i, ax in enumerate(axs.flat):
    ax.plot(x, y_data[i], '--', color='orange', label='True')
    ax.plot(x, y_pred_data[i], '-', color='blue', label='Prediction')
    ax.set_xlabel('Wavelength')
    ax.set_ylabel('Intensity')
    ax.legend()

plt.tight_layout()
plt.show()

# Log the figure to Wandb
wandb.log({"3x2_figure": wandb.Image(plt)})